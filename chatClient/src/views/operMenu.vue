<template>
  <div class="oper-menu">
    <div placement="right">
      <!-- <span class="el-dropdown-link">
        <el-badge is-dot :value="validateUnReadCount" :hidden="!validateUnReadCount">
          <i class="oper-item el-icon-s-operation"></i>
        </el-badge>
      </span> -->
      <div slot="dropdown">
        <div class="dropdowm-item">
          <router-link to="/chat/setting" class="aside-menu-link">
            <div type="text" title="个人信息">
              <svg t="1636359710057" class="icon" viewBox="0 0 1324 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="10093" width="30" height="30">
                <path d="M301.438003 976.001636H75.100889a27.516304 27.516304 0 0 1-27.309414-27.309414V75.204747a27.516304 27.516304 0 0 1 27.309414-27.309414H926.864965a23.999182 23.999182 0 1 0 0-47.791474H75.100889A75.307778 75.307778 0 0 0 0 67.136057v889.624855a75.514668 75.514668 0 0 0 74.68711 67.239088h226.750893a23.999182 23.999182 0 0 0 0-47.998364zM1324.092808 67.136057A75.307778 75.307778 0 0 0 1248.991919 0.103859H1022.654804a23.999182 23.999182 0 1 0 0 47.791474h226.337115a27.516304 27.516304 0 0 1 27.309414 27.309414v873.487475a27.516304 27.516304 0 0 1-27.309414 27.309414H397.227842a23.999182 23.999182 0 1 0 0 47.998364h851.764077A75.514668 75.514668 0 0 0 1324.092808 956.760912v-889.624855z" p-id="10094" fill="#555555"></path><path d="M635.564548 255.405503m9.723806 0l239.164264 0q9.723807 0 9.723806 9.723807l0 28.343861q0 9.723807-9.723806 9.723807l-239.164264 0q-9.723807 0-9.723806-9.723807l0-28.343861q0-9.723807 9.723806-9.723807Z" p-id="10095" fill="#555555"></path><path d="M635.564548 356.988248m9.723806 0l496.741693 0q9.723807 0 9.723806 9.723807l0 28.343861q0 9.723807-9.723806 9.723807l-496.741693 0q-9.723807 0-9.723806-9.723807l0-28.343861q0-9.723807 9.723806-9.723807Z" p-id="10096" fill="#555555"></path><path d="M635.564548 458.570993m9.723806 0l513.499742 0q9.723807 0 9.723807 9.723807l0 28.343861q0 9.723807-9.723807 9.723807l-513.499742 0q-9.723807 0-9.723806-9.723807l0-28.343861q0-9.723807 9.723806-9.723807Z" p-id="10097" fill="#555555"></path><path d="M635.564548 560.153738m9.723806 0l431.5715 0q9.723807 0 9.723806 9.723807l0 28.343862q0 9.723807-9.723806 9.723806l-431.5715 0q-9.723807 0-9.723806-9.723806l0-28.343862q0-9.723807 9.723806-9.723807Z" p-id="10098" fill="#555555"></path><path d="M635.564548 661.736483m9.723806 0l461.363588 0q9.723807 0 9.723807 9.723807l0 28.343862q0 9.723807-9.723807 9.723806l-461.363588 0q-9.723807 0-9.723806-9.723806l0-28.343862q0-9.723807 9.723806-9.723807Z" p-id="10099" fill="#555555"></path><path d="M635.564548 763.319228m9.723806 0l73.652663 0q9.723807 0 9.723806 9.723807l0 28.343862q0 9.723807-9.723806 9.723806l-73.652663 0q-9.723807 0-9.723806-9.723806l0-28.343862q0-9.723807 9.723806-9.723807Z" p-id="10100" fill="#555555"></path>
                <path d="M362.263517 322.437701m-147.719104 0a147.719104 147.719104 0 1 0 295.438207 0 147.719104 147.719104 0 1 0-295.438207 0Z" p-id="10101" fill="#555555"></path>
                <path d="M558.601653 724.217113s-20.68895-121.857916-28.136972-142.133088a32.895431 32.895431 0 0 0-26.274967-22.550955H210.613512a32.895431 32.895431 0 0 0-26.274966 22.550955c-6.206685 20.68895-27.930083 142.133087-27.930083 142.133088a41.3779 41.3779 0 0 0 7.654911 33.10232c12.206481 17.792497 130.340386 91.858939 193.027905 91.858938s180.821424-73.859552 193.234794-91.652049A41.3779 41.3779 0 0 0 558.601653 724.217113z" p-id="10102" fill="#555555"></path>
              </svg>
            </div>
          </router-link>
        </div>
        <div class="dropdowm-item">
          <el-badge
            :value="validateUnReadCount"
            :hidden="!validateUnReadCount"
          >
            <router-link to="/chat/system" class="aside-menu-link">
              <div type="text" title="系统消息">
                <svg t="1636359817660" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="10460" width="30" height="30">
                  <path d="M960.364169 254.738775c-2.433422 20.125363-11.332093 39.523155-26.590612 54.870702L577.759191 665.623843c-36.450167 36.450167-96.011704 36.450167-132.444475 0L89.30035 309.609477c-15.364943-15.347546-24.264637-34.834366-26.609031-54.870702-0.462534 3.836375-0.74599 7.673773-0.74599 11.617595l0 487.037469c0 51.513234 42.134633 93.665263 93.66731 93.665263l711.833281 0c51.514257 0 93.684706-42.152029 93.684706-93.665263L961.130625 266.355347C961.128579 262.411525 960.845123 258.57515 960.364169 254.738775L960.364169 254.738775zM577.759191 597.448114l373.244796-373.245819c-15.45397-30.535457-47.216371-51.513234-83.559091-51.513234L155.611615 172.689061c-36.344766 0-68.087725 20.977777-83.541695 51.513234l373.244796 373.245819C481.747487 633.880885 541.308001 633.880885 577.759191 597.448114L577.759191 597.448114zM577.759191 597.448114" p-id="10461" fill="#555555"></path>
                </svg>
              </div>
            </router-link>
          </el-badge>
        </div>
        <div class="dropdowm-item">
          <div type="text" @click="setShowTheme(true)" title="主题设置">
            <svg t="1636359381384" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="7683" width="30" height="30">
              <path d="M940 596l-76-57.6c0.8-8 1.6-16.8 1.6-26.4s-0.8-18.4-1.6-26.4l76-57.6c20.8-16 26.4-44 12.8-68l-84.8-143.2c-9.6-16.8-28-27.2-47.2-27.2-6.4 0-12 0.8-18.4 3.2L712 228c-15.2-10.4-31.2-19.2-47.2-26.4l-13.6-92c-4-26.4-26.4-45.6-53.6-45.6H426.4c-27.2 0-49.6 19.2-53.6 44.8L360 201.6c-16 7.2-31.2 16-47.2 26.4l-90.4-35.2c-6.4-2.4-12.8-3.2-19.2-3.2-19.2 0-37.6 9.6-46.4 26.4L71.2 360c-13.6 22.4-8 52 12.8 68l76 57.6c-0.8 9.6-1.6 18.4-1.6 26.4s0 16.8 1.6 26.4l-76 57.6c-20.8 16-26.4 44-12.8 68l84.8 143.2c9.6 16.8 28 27.2 47.2 27.2 6.4 0 12-0.8 18.4-3.2L312 796c15.2 10.4 31.2 19.2 47.2 26.4l13.6 92c3.2 25.6 26.4 45.6 53.6 45.6h171.2c27.2 0 49.6-19.2 53.6-44.8l13.6-92.8c16-7.2 31.2-16 47.2-26.4l90.4 35.2c6.4 2.4 12.8 3.2 19.2 3.2 19.2 0 37.6-9.6 46.4-26.4l85.6-144.8c12.8-23.2 7.2-51.2-13.6-67.2zM704 512c0 105.6-86.4 192-192 192S320 617.6 320 512s86.4-192 192-192 192 86.4 192 192z" p-id="7684" fill="#555555"></path>
            </svg>
          </div>
        </div>
        <div class="login-out">
          <div type="text" @click="logout" title="退出">
            <span class="login-out-item">
              <svg t="1636358266665" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="6135" width="30" height="30">
                <path d="M980.522459 379.849054C933.428449 222.83239 809.469502 99.652683 650.314927 53.038205v332.705093c0 76.065717-61.979473 137.395824-138.824429 137.395824-76.854946 0-138.824429-61.340098-138.82443-137.395824V53.527727C113.838829 129.103922-33.916878 398.500839 42.438556 654.650693c76.355434 256.149854 348.55961 402.387044 607.866381 326.810848 259.316761-75.566205 406.582946-345.452644 330.217522-601.612487z" p-id="6136" fill="#555555"></path>
                <path d="M511.480507 434.815376c38.182712 0 69.412215-30.909815 69.412215-68.702908V90.331785c0-37.783102-31.239493-68.702907-69.412215-68.702907C473.307785 21.638868 442.068293 52.548683 442.068293 90.331785v275.780683c0 37.783102 31.239493 68.702907 69.412214 68.702908z" p-id="6137" fill="#555555"></path>
              </svg>
            </span>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>

<script>
import { removeCookie } from "@/utils/token";
export default {
  computed: {
    userInfo() {
      return this.$store.state.user.userInfo;
    },
    unreadNews() {
      return this.$store.state.news.unreadNews;
    },
    validateUnReadCount() {
      const validateSysUser = (this.$store.state.app.sysUsers || []).find(
        item => item.code === "111111"
      );
      const key = (validateSysUser || {})._id + "-" + (this.userInfo || {})._id;
      return this.unreadNews[key];
    }
  },
  methods: {
    logout() {
      this.$router.replace("/login");
      this.$socket.emit("leave");
      this.$store.dispatch("user/LOGOUT");
      removeCookie();
    },
    setShowTheme(flag) {
      this.$emit("setShowTheme", flag);
    }
  }
};
</script>

<style lang="scss">
.oper-menu {
  position: relative;
  height: 100%;
  .menu-item {
    display: block;
  }
  .dropdowm-item {
    height: 40px;
    padding: 30px 0;
    text-align: center;
    cursor: pointer;
    // margin: 5px 0;
  }
  .login-out {
    cursor: pointer;
    position: absolute;
    bottom: 30px;
    left: 50%;
    transform: translateX(-50%);
  }
  .login-out svg:hover path {
    fill: #e73f32;
  }
}
</style>
